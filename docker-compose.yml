services:
  #  robot-arm:
  teleshake:
    build: ./teleshake/
    environment:
      - PORT=50050
    ports:
      - "50050:50050"
    dns:
      - 172.17.0.1
    extra_hosts:
      - "host.docker.internal:host-gateway"
    networks:
      server_net:
        ipv4_address: 192.168.200.3

  universal-sila-client:
    image: registry.gitlab.com/sila2/universal-sila-client/sila_universal_client:latest
    ports:
      - "8080:8080"
      - "50051:50051"
    dns:
      - 172.17.0.1
    extra_hosts:
      - "host.docker.internal:host-gateway"
    networks:
      server_net:
        ipv4_address: 192.168.200.2

  robot-arm:
    build: ./robot-arm/
    ports:
      - "50054:50054"
      - "8055:8055"
    dns:
      - 172.17.0.1
    extra_hosts:
      - "host.docker.internal:host-gateway"
    networks:
      server_net:
        ipv4_address: 192.168.200.4
    command: [ "python", "-m", "genericroboticarm", "--address", "0.0.0.0" ]

# Container for testing purposes
  python:
    image: python:3.12
    extra_hosts:
      - "host.docker.internal:host-gateway"
    networks:
      server_net:
        ipv4_address: 192.168.200.5
      outside:

networks:
  server_net:
    driver: bridge
    name: vu-lab
    ipam:
      config:
        - subnet: 192.168.200.0/24
          gateway: 192.168.200.1
  outside:
    driver: bridge
    internal: false